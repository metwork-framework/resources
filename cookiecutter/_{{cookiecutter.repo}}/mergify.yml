# automatically generated from https://github.com/metwork-framework/resources/blob/master/cookiecutter/%7B%7Bcookiecutter.repo%7D%7D/mergify.yml)

pull_request_rules:
{% if cookiecutter.integration_level|int >= 4 %}
- name: backport to 0.5
  conditions:
    - base=integration
    - label=backport-to-0.5
  actions:
    backport:
      branches:
        - release_0.5
- name: backport to 0.6
  conditions:
    - base=integration
    - label=backport-to-0.6
  actions:
    backport:
      branches:
        - release_0.6
- name: backport to 0.7
  conditions:
    - base=integration
    - label=backport-to-0.7
  actions:
    backport:
      branches:
        - release_0.7
- name: release branch
  actions:
    merge:
      method: merge
      strict: true
    delete_head_branch: {}
  conditions:
    - base~=^release_
    - -merged
    - -closed
    - label!=Merge Manual
    - status-success=pr ready to merge
    - status-success=license/cla
{% if cookiecutter.repo != 'mfext' and cookiecutter.repo != 'testrepo' %}
    - status-success=continuous-integration/drone/pr
{% endif %}
- name: integration branch
  actions:
    merge:
      method: merge
      strict: true
    delete_head_branch: {}
  conditions:
    - base=integration
    - -merged
    - -closed
    - label!=Merge Manual
    - status-success=pr ready to merge
    - status-success=license/cla
{% if cookiecutter.repo != 'mfext' and cookiecutter.repo != 'testrepo' %}
    - status-success=continuous-integration/drone/pr
{% endif %}
{% else %}
- name: master branch
  actions:
    merge:
      method: merge
      strict: true
    delete_head_branch: {}
  conditions:
    - base=master
    - -merged
    - -closed
    - label!=Merge Manual
    - status-success=continuous-integration/drone/pr
    - '#approved-reviews-by>=1'
- name: master branch forced
  actions:
    merge:
      method: merge
      strict: true
    delete_head_branch: {}
  conditions:
    - base=master
    - -merged
    - -closed
    - label!=Merge Manual
    - label=Merge Now
{% endif %}
